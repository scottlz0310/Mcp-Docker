# GitHub Actions Simulator - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ›¸

## æ¦‚è¦

ä½¿ã„ã‚„ã™ã•ã‚’æœ€é‡è¦–ã—ãŸGitHub Actions Simulatorã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆã§ã™ã€‚é–‹ç™ºè€…ãŒç›´æ„Ÿçš„ã«æ“ä½œã§ãã€åŠ¹ç‡çš„ãªCIäº‹å‰æ¤œè¨¼ã‚’å¯èƒ½ã«ã™ã‚‹ã“ã¨ã‚’ç›®æ¨™ã¨ã—ã¾ã™ã€‚

## ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹éšå±¤

```
GitHub Actions Simulator
â”œâ”€â”€ CLI Interface (Primary)
â”œâ”€â”€ Web UI (Optional, Future)
â””â”€â”€ API Interface (Internal/External)
```

## CLI ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰æ§‹é€ 

```bash
python main.py actions <command> [options] <workflow>...
```

è¤‡æ•°ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’åŒæ™‚ã«æŒ‡å®šã§ãã‚‹ç‚¹ãŒæ–°ã—ã„ç‰¹é•·ã§ã™ã€‚ç¬¬ä¸€å¼•æ•°ã«ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ï¼ˆ`simulate` / `validate` / `list-jobs`ï¼‰ã‚’æŒ‡å®šã—ã€ç¶šãå¼•æ•°ã§å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¸¡ã—ã¾ã™ã€‚

### ãƒ¡ã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰

#### 1. ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ (`simulate`)

```bash
# å˜ä¸€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œ
python main.py actions simulate .github/workflows/ci.yml

# ç‰¹å®šã‚¸ãƒ§ãƒ–ã®ã¿å®Ÿè¡Œ
python main.py actions simulate .github/workflows/ci.yml --job test

# è¤‡æ•°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é€£ç¶šå®Ÿè¡Œï¼ˆfail-fastå¯¾å¿œï¼‰
python main.py actions simulate \
  .github/workflows/ci.yml workflows/security.yml --fail-fast
```

#### 2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¤œè¨¼ (`validate`)

```bash
# ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã§æ¤œè¨¼
python main.py actions validate .github/workflows/ci.yml --strict

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã‚’å†å¸°çš„ã«æ¤œè¨¼
python main.py actions validate .github/workflows
```

#### 3. ã‚¸ãƒ§ãƒ–ä¸€è¦§è¡¨ç¤º (`list-jobs`)

```bash
python main.py actions list-jobs .github/workflows/ci.yml --format json
```

### Makefile é€£æº (`make actions`)

```bash
# å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆEnter=1 ã§å…ˆé ­ã‚’å®Ÿè¡Œï¼‰
make actions

# éå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆCI/AIå‘ã‘ï¼‰
make actions WORKFLOW=.github/workflows/ci.yml

# ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æŒ‡å®š
INDEX=2 make actions

# è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’CLIã«æ¸¡ã™
make actions WORKFLOW=.github/workflows/ci.yml \
  CLI_ARGS="--event pull_request --ref refs/pull/42/head --output-format json"
```

| å¤‰æ•°        | å½¹å‰²                                     |
|-------------|------------------------------------------|
| `WORKFLOW`  | å®Ÿè¡Œã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹         |
| `INDEX`     | ä¸€è¦§ã®ç•ªå·æŒ‡å®šï¼ˆ1å§‹ã¾ã‚Šï¼‰               |
| `JOB`       | ç‰¹å®šã‚¸ãƒ§ãƒ–ã®ã¿å®Ÿè¡Œ                      |
| `DRY_RUN`   | 1 ã‚’æŒ‡å®šã™ã‚‹ã¨ãƒ—ãƒ©ãƒ³ã®ã¿è¡¨ç¤º            |
| `ENGINE`    | `builtin` / `act` ã®åˆ‡ã‚Šæ›¿ãˆ             |
| `VERBOSE` / `QUIET` / `DEBUG` | CLIã®å‡ºåŠ›é‡ã‚’åˆ¶å¾¡        |
| `CONFIG`    | TOML è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š                 |
| `ENV_FILE`  | è¿½åŠ ã®ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«                  |
| `EVENT` / `REF` / `ACTOR` | GitHub ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä¸Šæ›¸ã |
| `ENV_VARS`  | `KEY=VALUE` å½¢å¼ã‚’ç©ºç™½åŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®š  |
| `CLI_ARGS`  | ãã®ä»–ã® CLI ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä¸¸ã”ã¨é€£çµ     |

äººé–“ã¯ `make actions` ã®ç•ªå·é¸æŠã ã‘ã§æ“ä½œã§ãã€AI ã‚„è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã¯å¤‰æ•°æŒ‡å®šã§å³æ™‚ã«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’èµ°ã‚‰ã›ã‚‰ã‚Œã‚‹ã‚ˆã†è¨­è¨ˆã—ã¦ã„ã‚‹ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­è¨ˆ

#### ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
-v, --verbose        # è©³ç´°ãƒ­ã‚°è¡¨ç¤º
-q, --quiet          # æœ€å°é™ã®å‡ºåŠ›
  --debug          # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼ˆverboseã‚’å†…åŒ…ï¼‰
  --config PATH    # TOMLè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
  --version        # CLIãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
```

#### å®Ÿè¡Œã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
# ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒˆãƒªã‚¬ãƒ¼æŒ‡å®š
  --event EVENT            # GitHubã‚¤ãƒ™ãƒ³ãƒˆåï¼ˆä¾‹: push, pull_requestï¼‰
  --ref REF                # Gitãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼ˆä¾‹: refs/heads/mainï¼‰
  --actor NAME             # å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼

# å®Ÿè¡Œåˆ¶å¾¡
  --job JOB_ID             # ç‰¹å®šã‚¸ãƒ§ãƒ–ã®ã¿å®Ÿè¡Œ
  --dry-run                # å®Ÿéš›ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã¯è¡Œã‚ãšãƒ—ãƒ©ãƒ³ã®ã¿è¡¨ç¤º
  --engine builtin|act     # å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆ
  --fail-fast              # æœ€åˆã®å¤±æ•—ã§æ®‹ã‚Šã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ã‚¹ã‚­ãƒƒãƒ—

# ç’°å¢ƒè¨­å®š
  --env-file PATH          # .env äº’æ›ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã¿
  --env KEY=VALUE          # è¿½åŠ ã®ç’°å¢ƒå¤‰æ•°æŒ‡å®šï¼ˆè¤‡æ•°å¯ï¼‰

# å‡ºåŠ›åˆ¶å¾¡
  --output-format console|json  # å®Ÿè¡Œã‚µãƒãƒªãƒ¼ã®å½¢å¼
  --output-file PATH            # ã‚µãƒãƒªãƒ¼ã‚’JSONã¨ã—ã¦ä¿å­˜
```

### ä½¿ç”¨ä¾‹

```bash
# ğŸ¯ é–‹ç™ºä¸­ã®ä¸€èˆ¬çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

# 1. åŸºæœ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ
mcp-docker sim ci.yml

# 2. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã§ã®å®Ÿè¡Œ
mcp-docker sim ci.yml --event pull_request --ref refs/pull/123/head

# 3. ç‰¹å®šã‚¸ãƒ§ãƒ–ã®ã¿å®Ÿè¡Œï¼ˆé«˜é€Ÿãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰
mcp-docker sim ci.yml --job test

# 4. ç’°å¢ƒå¤‰æ•°ä»˜ãã§å®Ÿè¡Œ
mcp-docker sim ci.yml --env NODE_ENV=development --env-file .env.test

# 5. è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆä»˜ãå®Ÿè¡Œ
mcp-docker sim ci.yml --output-format html --output-file ci-report.html

# 6. ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§ã®å®Ÿè¡Œ
mcp-docker sim ci.yml --job build --debug --verbose

# 7. è¤‡æ•°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œï¼ˆçµ±åˆãƒ†ã‚¹ãƒˆï¼‰
mcp-docker sim run ci.yml security.yml --fail-fast
```

## ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›è¨­è¨ˆ

### å®Ÿè¡Œä¸­ã®è¡¨ç¤º

```bash
ğŸš€ GitHub Actions Simulator v1.0.0
ğŸ“„ Workflow: .github/workflows/ci.yml
ğŸ¯ Event: push
ğŸŒ¿ Ref: refs/heads/main

â±ï¸  Parsing workflow... âœ… Done (0.1s)
ğŸ” Validating dependencies... âœ… Done (0.2s)
ğŸ³ Preparing Docker environment... âœ… Done (1.2s)

ğŸ“‹ Execution Plan:
  â””â”€â”€ Job: lint (ubuntu-latest)
      â”œâ”€â”€ Checkout code
      â”œâ”€â”€ Lint Dockerfile
      â””â”€â”€ Lint Shell scripts
  â””â”€â”€ Job: build (ubuntu-latest, needs: lint)
      â”œâ”€â”€ Checkout code
      â”œâ”€â”€ Set up Docker Buildx
      â””â”€â”€ Build Docker image

ğŸƒ Starting execution...

â”Œâ”€ Job: lint â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ³ Container: ubuntu:latest                        â”‚
â”‚ â±ï¸  Started: 2025-01-15 10:30:15                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¥ Step 1/3: Checkout code                         â”‚
â”‚ âœ… actions/checkout@v4 completed (2.1s)            â”‚
â”‚                                                     â”‚
â”‚ ğŸ” Step 2/3: Lint Dockerfile                       â”‚
â”‚ âœ… hadolint completed successfully (1.8s)          â”‚
â”‚                                                     â”‚
â”‚ ğŸ§¹ Step 3/3: Lint Shell scripts                    â”‚
â”‚ âœ… shellcheck completed successfully (3.2s)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Job completed successfully (7.1s)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Job: build â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ³ Container: ubuntu:latest                        â”‚
â”‚ â±ï¸  Started: 2025-01-15 10:30:22                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¥ Step 1/3: Checkout code                         â”‚
â”‚ âœ… actions/checkout@v4 completed (1.9s)            â”‚
â”‚                                                     â”‚
â”‚ ğŸ”§ Step 2/3: Set up Docker Buildx                  â”‚
â”‚ âœ… docker/setup-buildx-action@v3 completed (4.5s)  â”‚
â”‚                                                     â”‚
â”‚ ğŸ—ï¸  Step 3/3: Build Docker image                   â”‚
â”‚ âœ… Docker build completed successfully (45.2s)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Job completed successfully (51.6s)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ‰ Workflow completed successfully!
â±ï¸  Total execution time: 58.7s
ğŸ“Š Jobs: 2 completed, 0 failed
ğŸ“ˆ Success rate: 100%
```

### ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

```bash
âŒ Job: test failed

â”Œâ”€ Job: test â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ³ Container: ubuntu:latest                        â”‚
â”‚ â±ï¸  Started: 2025-01-15 10:35:10                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¥ Step 1/2: Checkout code                         â”‚
â”‚ âœ… actions/checkout@v4 completed (2.0s)            â”‚
â”‚                                                     â”‚
â”‚ ğŸ§ª Step 2/2: Run tests                             â”‚
â”‚ âŒ pytest failed with exit code 1                  â”‚
â”‚                                                     â”‚
â”‚ ğŸ“‹ Error Details:                                  â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚ FAILED tests/test_main.py::test_version - Assert... â”‚
â”‚ AssertionError: assert '1.0.0' == '1.0.1'         â”‚
â”‚   - 1.0.1                                          â”‚
â”‚   + 1.0.0                                          â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ Job failed (12.3s)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ Suggestions:
  â€¢ Check test expectations in tests/test_main.py
  â€¢ Verify version number in main.py matches expected value
  â€¢ Run tests locally: pytest tests/test_main.py::test_version

ğŸ“Š Summary:
  âœ… 1 job completed successfully
  âŒ 1 job failed
  â±ï¸  Total time: 14.3s
  ğŸ”— Detailed logs: ./output/simulation-20250115-103510.log
```

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ

### ãƒ¡ã‚¤ãƒ³è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (simulator.toml)

```toml
[simulator]
version = "1.0.0"
default_event = "push"
default_runner = "ubuntu-latest"
cleanup_after_run = true
max_parallel_jobs = 4

[docker]
network = "actions-simulator"
image_cache = true
pull_policy = "if-not-present"

[runners]
"ubuntu-latest" = "ghcr.io/catthehacker/ubuntu:act-latest"
"ubuntu-22.04" = "ghcr.io/catthehacker/ubuntu:act-22.04"
"ubuntu-20.04" = "ghcr.io/catthehacker/ubuntu:act-20.04"

[actions]
allowed_actions = [
  "actions/checkout@*",
  "actions/setup-python@*",
  "actions/setup-node@*",
  "docker/setup-buildx-action@*"
]

[security]
network_access = false
allow_privileged = false
secret_masking = true

[output]
default_format = "console"
log_level = "info"
color = true
```

### ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ« (.env.simulator)

```bash
# GitHubé–¢é€£
GITHUB_TOKEN=ghp_xxxxxxxxxxxx
GITHUB_ACTOR=testuser
GITHUB_REPOSITORY=owner/repo

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰
NODE_ENV=test
DATABASE_URL=sqlite:///test.db
API_KEY=test-api-key

# Dockeré–¢é€£
DOCKER_BUILDKIT=1
BUILDX_EXPERIMENTAL=1
```

### ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ« (.secrets.json)

```json
{
  "GITHUB_TOKEN": "ghp_xxxxxxxxxxxx",
  "DOCKER_PASSWORD": "supersecret123",
  "API_SECRET_KEY": "secret-key-value",
  "DATABASE_PASSWORD": "db-password"
}
```

## API ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

### REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```yaml
# OpenAPI 3.0 specification
openapi: 3.0.0
info:
  title: GitHub Actions Simulator API
  version: 1.0.0

paths:
  /api/v1/simulate:
    post:
      summary: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œé–‹å§‹
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [workflow_path]
              properties:
                workflow_path:
                  type: string
                  example: ".github/workflows/ci.yml"
                event:
                  type: string
                  enum: [push, pull_request, schedule]
                  default: push
                environment:
                  type: object
                  additionalProperties:
                    type: string

  /api/v1/simulate/{run_id}:
    get:
      summary: å®Ÿè¡ŒçŠ¶æ³å–å¾—
      parameters:
        - name: run_id
          in: path
          required: true
          schema:
            type: string

  /api/v1/workflows:
    get:
      summary: åˆ©ç”¨å¯èƒ½ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸€è¦§
      responses:
        '200':
          description: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸€è¦§
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Workflow'

components:
  schemas:
    Workflow:
      type: object
      properties:
        name:
          type: string
        path:
          type: string
        jobs:
          type: array
          items:
            $ref: '#/components/schemas/Job'

    Job:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        runs-on:
          type: string
        needs:
          type: array
          items:
            type: string
```

## Web UI è¨­è¨ˆ (Future Phase)

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš€ GitHub Actions Simulator                   [Settings] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ ğŸ“Š å®Ÿè¡Œçµ±è¨ˆ (éå»30æ—¥)                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ç·å®Ÿè¡Œå›æ•°    â”‚ æˆåŠŸç‡      â”‚ å¹³å‡å®Ÿè¡Œæ™‚é–“   â”‚ æœ€çµ‚å®Ÿè¡Œ      â”‚     â”‚
â”‚ â”‚ 247å›       â”‚ 94.3%      â”‚ 3m 42s     â”‚ 2åˆ†å‰       â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ ğŸ”„ æœ€è¿‘ã®å®Ÿè¡Œ                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ âœ… ci.yml          â”‚ 3m 21s â”‚ 2åˆ†å‰   â”‚ [ãƒ­ã‚°] [å†å®Ÿè¡Œ] â”‚     â”‚
â”‚ â”‚ âŒ security.yml    â”‚ 1m 45s â”‚ 15åˆ†å‰  â”‚ [ãƒ­ã‚°] [å†å®Ÿè¡Œ] â”‚     â”‚
â”‚ â”‚ âœ… release.yml     â”‚ 8m 12s â”‚ 1æ™‚é–“å‰ â”‚ [ãƒ­ã‚°] [å†å®Ÿè¡Œ] â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ ğŸ¯ ã‚¯ã‚¤ãƒƒã‚¯å®Ÿè¡Œ                                              â”‚
â”‚ â”Œâ”€ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é¸æŠ â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚ â—‹ ci.yml                â”‚ â”‚ Event: [push â–¼]    â”‚        â”‚
â”‚ â”‚ â—‹ security.yml          â”‚ â”‚ Branch: [main]     â”‚        â”‚
â”‚ â”‚ â—‹ release.yml           â”‚ â”‚ Job: [å…¨ã¦ â–¼]       â”‚        â”‚
â”‚ â”‚ â—‹ docs.yml              â”‚ â”‚                   â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â”‚                              [ğŸš€ å®Ÿè¡Œé–‹å§‹]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®Ÿè¡Œè©³ç´°ç”»é¢

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ci.yml - å®Ÿè¡Œè©³ç´°                            [ğŸ”„] [âŒ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ push event â€¢ main branch â€¢ 3m 21s â€¢ âœ… æˆåŠŸ              â”‚
â”‚                                                             â”‚
â”‚ ğŸ“Š é€²è¡ŒçŠ¶æ³                                                  â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (2/2)       â”‚
â”‚                                                             â”‚
â”‚ ğŸ”„ ã‚¸ãƒ§ãƒ–å®Ÿè¡Œãƒ•ãƒ­ãƒ¼                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚ â”‚  lint   â”‚â”€â”€â”€â–¶â”‚  build  â”‚                                â”‚
â”‚ â”‚ âœ… 1m2s  â”‚    â”‚ âœ… 2m19s â”‚                                â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                             â”‚
â”‚ ğŸ“ å®Ÿè¡Œãƒ­ã‚°                                  [ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰]    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ lint                                   â–¼ [å±•é–‹/æŠ˜ç•³]  â”‚     â”‚
â”‚ â”‚ â”œâ”€â”€ ğŸ“¥ Checkout code (2.1s) âœ…                        â”‚     â”‚
â”‚ â”‚ â”œâ”€â”€ ğŸ” Lint Dockerfile (1.8s) âœ…                      â”‚     â”‚
â”‚ â”‚ â””â”€â”€ ğŸ§¹ Lint Shell scripts (3.2s) âœ…                   â”‚     â”‚
â”‚ â”‚                                                       â”‚     â”‚
â”‚ â”‚ build                                  â–¼ [å±•é–‹/æŠ˜ç•³]  â”‚     â”‚
â”‚ â”‚ â”œâ”€â”€ ğŸ“¥ Checkout code (1.9s) âœ…                        â”‚     â”‚
â”‚ â”‚ â”œâ”€â”€ ğŸ”§ Set up Docker Buildx (4.5s) âœ…                 â”‚     â”‚
â”‚ â”‚ â””â”€â”€ ğŸ—ï¸ Build Docker image (45.2s) âœ…                  â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ ğŸ›ï¸ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³                                               â”‚
â”‚ [ğŸ“‹ ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›] [ğŸ”„ å†å®Ÿè¡Œ] [ğŸ“Š çµ±è¨ˆ] [ğŸ“¤ å…±æœ‰]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ»ä½¿ã„ã‚„ã™ã•

### CLIä½¿ã„ã‚„ã™ã•æ©Ÿèƒ½

1. **ãƒãƒ«ãƒãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã¨ fail-fast**

   ```bash
   python main.py actions simulate ci.yml security.yml --fail-fast
   ```

   1ã‚³ãƒãƒ³ãƒ‰ã§è¤‡æ•°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é€£ç¶šå®Ÿè¡Œã—ã€`--fail-fast` ãŒæœ€åˆã®å¤±æ•—å¾Œã«æ®‹ã‚Šã®å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚

1. **JSON/ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®æŸ”è»Ÿãªã‚µãƒãƒªãƒ¼è¡¨ç¤º**

   ```bash
   python main.py actions simulate ci.yml --output-format json --output-file summary.json
   ```

   Rich ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚ˆã‚‹ã‚«ãƒ©ãƒ¼å‡ºåŠ›ã¨ã€JSONãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã«ã‚ˆã‚‹ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•åŒ–ã®ä¸¡æ–¹ã«å¯¾å¿œã—ã¾ã™ã€‚

1. **ç’°å¢ƒå¤‰æ•°ã®ä¸Šæ›¸ãã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«çµ±åˆ**

   ```bash
   python main.py actions simulate ci.yml --config simulator.toml --env GITHUB_ACTOR=local
   ```

   TOML è¨­å®šã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’èª­ã¿è¾¼ã¿ã¤ã¤ã€`--env` ã‚„ `--env-file` ã§æœ¬ç•ªç›¸å½“ã®ç’°å¢ƒã‚’ç°¡å˜ã«å†ç¾ã§ãã¾ã™ã€‚

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

1. **åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**

  ```bash
   âŒ Error: Workflow file not found

   ğŸ“ Searched locations:
     â€¢ .github/workflows/ci.yml
     â€¢ ./ci.yml
     â€¢ workflows/ci.yml

   ğŸ’¡ Did you mean:
     â€¢ .github/workflows/ci-test.yml
     â€¢ .github/workflows/build.yml
   ```

1. **ä¿®æ­£ææ¡ˆ**
   - è¨­å®šãƒŸã‚¹ã®è‡ªå‹•æ¤œå‡º
   - å…·ä½“çš„ãªä¿®æ­£æ–¹æ³•ã®æç¤º
   - é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®ãƒªãƒ³ã‚¯

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¡¨ç¤º

```bash
ğŸ“ˆ Performance Summary:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Job              â”‚ Duration â”‚ CPU Usage    â”‚ Memory     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ lint             â”‚ 1m 02s   â”‚ 45%          â”‚ 512 MB     â”‚
â”‚ build            â”‚ 2m 19s   â”‚ 78%          â”‚ 1.2 GB     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total            â”‚ 3m 21s   â”‚ 62% (avg)    â”‚ 1.7 GB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ Performance Tips:
  â€¢ build job uses high memory - consider using smaller base images
  â€¢ Enable Docker layer caching for faster builds
  â€¢ Consider splitting build job into smaller steps
```

## çµ±åˆé–‹ç™ºç’°å¢ƒï¼ˆIDEï¼‰é€£æº

### VS Code Extension (Future)

```json
{
  "commands": [
    {
      "command": "github-actions-simulator.run",
      "title": "Run Workflow",
      "category": "GitHub Actions"
    },
    {
      "command": "github-actions-simulator.validate",
      "title": "Validate Workflow",
      "category": "GitHub Actions"
    }
  ],
  "keybindings": [
    {
      "command": "github-actions-simulator.run",
      "key": "ctrl+shift+a",
      "when": "editorTextFocus && resourceExtname == .yml"
    }
  ]
}
```

## ã¾ã¨ã‚

ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆã¯ã€é–‹ç™ºè€…ã®æ—¥å¸¸çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«è‡ªç„¶ã«çµ±åˆã•ã‚Œã€GitHub Actions ã®äº‹å‰æ¤œè¨¼ã‚’åŠ¹ç‡çš„ã‹ã¤ç›´æ„Ÿçš„ã«è¡Œãˆã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚

**ä¸»è¦ãªç‰¹å¾´:**

- ğŸš€ **é«˜é€Ÿèµ·å‹•**: 1ã‚³ãƒãƒ³ãƒ‰ã§å³åº§ã«å®Ÿè¡Œé–‹å§‹
- ğŸ¯ **ç›´æ„Ÿçš„æ“ä½œ**: è¦šãˆã‚„ã™ã„ã‚³ãƒãƒ³ãƒ‰ä½“ç³»
- ğŸ“Š **è±Šå¯Œãªæƒ…å ±**: å®Ÿè¡ŒçŠ¶æ³ã€çµ±è¨ˆã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æƒ…å ±
- ğŸ” **å„ªã‚ŒãŸãƒ‡ãƒãƒƒã‚°**: è©³ç´°ãƒ­ã‚°ã€ã‚¨ãƒ©ãƒ¼è¨ºæ–­ã€ä¿®æ­£ææ¡ˆ
- âš¡ **æŸ”è»Ÿãªè¨­å®š**: ç’°å¢ƒã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€å‡ºåŠ›å½¢å¼ã®è‡ªç”±ãªçµ„ã¿åˆã‚ã›

æ®µéšçš„ãªå®Ÿè£…ã«ã‚ˆã‚Šã€ã¾ãšã¯ CLI ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Œç’§ã«ä»•ä¸Šã’ã€ãã®å¾Œ Web UI ã‚„ IDE çµ±åˆãªã©ã€ã‚ˆã‚Šé«˜åº¦ãªæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãè¨ˆç”»ã§ã™ã€‚
